<!-- Services -->
{% if site.locale and site.locale != "" and site.locale != nil %}
  <section class="page-section services-section" id="{{ site.data.sitetext[site.locale].services.section | default: "services" }}">
    <div class="services-overlay">
    </div>
    <div class="container" style="position: relative; z-index: 2;">
      <div class="row">
        <div class="col-lg-12 text-center service-fade">
          <h2 class="section-heading service-fade text-uppercase">{{ site.data.sitetext[site.locale].services.title | default: "Services" }}</h2>
          {% if site.data.sitetext[site.locale].services.text %}
		  <h3 class="section-subheading service-fade text-muted">{{ site.data.sitetext[site.locale].services.text }}</h3>
		  {% endif %}
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="carousel-wrapper service-fade">
            <button class="carousel-btn carousel-btn-left" id="prevBtn">‹</button>
            
            <div class="carousel-3d-container">
              <div class="carousel-3d" id="carousel3d">
                {% for service in site.data.sitetext[site.locale].services.list %}
                  <div class="carousel-item-3d" data-index="{{ forloop.index0 }}">
                    <div class="service-icon">
                      <i class="{{ service.icon | default: "fas fa-shopping-cart" }}"></i>
                    </div>
                    <h4 class="service-title">{{ service.title | markdownify }}</h4>
                    {% if service.desc %}
                      <div class="service-desc">{{ service.desc | markdownify }}</div>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            </div>
            
            <button class="carousel-btn carousel-btn-right" id="nextBtn">›</button>
          </div>
          
          <div class="carousel-indicators-3d service-fade">
            {% for service in site.data.sitetext[site.locale].services.list %}
              <div class="indicator {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}"></div>
            {% endfor %}
          </div>
        </div>
      </div>
	  
    </div>
  </section>
{% else %}
<section class="page-section services-section" id="{{ site.data.sitetext.services.section | default: "services" }}">
  <div class="services-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.3); z-index: 1;"></div>
  <div class="container" style="position: relative; z-index: 2;">
    <div class="row">
      <div class="col-lg-12 text-center">
        <h2 class="section-heading text-uppercase">{{ site.data.sitetext.services.title | default: "Services" }}</h2>
        {% if site.data.sitetext.services.text %}
    <h3 class="section-subheading text-muted">{{ site.data.sitetext.services.text }}</h3>
    {% endif %}
      </div>
    </div>
  
    <div class="row">
      <div class="col-md-12">
        <div class="carousel-wrapper service-fade">
          <button class="carousel-btn carousel-btn-left" id="prevBtn">‹</button>
          
          <div class="carousel-3d-container">
            <div class="carousel-3d" id="carousel3d">
              {% for service in site.data.sitetext.services.list %}
                <div class="carousel-item-3d" data-index="{{ forloop.index0 }}">
                  <div class="service-icon">
                    <i class="{{ service.icon | default: "fas fa-shopping-cart" }}"></i>
                  </div>
                  <h4 class="service-title">{{ service.title | markdownify }}</h4>
                  {% if service.desc %}
                    <div class="service-desc">{{ service.desc | markdownify }}</div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          </div>
          
          <button class="carousel-btn carousel-btn-right" id="nextBtn">›</button>
        </div>
        
        <div class="carousel-indicators-3d service-fade">
          {% for service in site.data.sitetext.services.list %}
            <div class="indicator {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}"></div>
          {% endfor %}
        </div>
      </div>
    </div>
  
  </div>
</section>
{% endif %}

<script>
  // Fade-in animation functionality
  const sections = document.querySelectorAll('.page-section');

  function checkVisibility() {
    sections.forEach(section => {
      const elementsToAnimate = section.querySelectorAll('.service-fade > *');
      const triggerPoint = window.innerHeight * 0.8;
      const sectionTop = section.getBoundingClientRect().top;

      elementsToAnimate.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        if (elementTop < triggerPoint && sectionTop < window.innerHeight) {
          element.classList.add('visible');
        } else {
          element.classList.remove('visible');
        }
      });
    });
  }

  window.addEventListener('scroll', checkVisibility);
  window.addEventListener('resize', checkVisibility);
  window.addEventListener('load', checkVisibility);
</script>
<!-- End Services -->